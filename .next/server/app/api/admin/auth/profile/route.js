"use strict";(()=>{var e={};e.id=926,e.ids=[926],e.modules={8013:e=>{e.exports=require("mongodb")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},1901:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>x,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var n={};a.r(n),a.d(n,{GET:()=>d});var r=a(9303),i=a(8716),o=a(670),c=a(7070),s=a(2021),u=a(4770),l=a.n(u);async function d(e){try{var t;let{db:a}=await (0,s.vO)(),n=(0,s.ac)(a),r=e.headers.get("Authorization");if(!r||!r.startsWith("Bearer "))return c.NextResponse.json({success:!1,message:"No token provided"},{status:401});let i=(t=r.substring(7),l().createHash("sha256").update(t).digest("hex")),o=await n.findOne({tokenHash:i});if(!o)return c.NextResponse.json({success:!1,message:"Invalid token"},{status:401});return c.NextResponse.json({success:!0,data:{email:o.email,name:o.name,role:o.role}})}catch(e){return console.error("Profile validation error:",e),c.NextResponse.json({success:!1,message:"Internal server error"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/auth/profile/route",pathname:"/api/admin/auth/profile",filename:"route",bundlePath:"app/api/admin/auth/profile/route"},resolvedPagePath:"C:\\Users\\USER\\Desktop\\BarracudaMareting\\app\\api\\admin\\auth\\profile\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:x,staticGenerationAsyncStorage:f,serverHooks:m}=p,g="/api/admin/auth/profile/route";function w(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}},2021:(e,t,a)=>{a.d(t,{BF:()=>d,CL:()=>l,MU:()=>p,ac:()=>x,g:()=>f,vO:()=>s});var n=a(8013);let r=null,i=null,o=process.env.MONGODB_URI||"mongodb://127.0.0.1:27017",c=process.env.DB_NAME||"barracuda";async function s(){if(r&&i)return{client:r,db:i};try{return r=new n.MongoClient(o),await r.connect(),i=r.db(c),console.log("✅ Connected to MongoDB"),await u(i),{client:r,db:i}}catch(e){throw console.error("❌ MongoDB connection error:",e),e}}async function u(e){let t=e.collection("contacts");await t.createIndex({email:1}),await t.createIndex({type:1}),await t.createIndex({status:1}),await t.createIndex({affiliate_id:1}),await t.createIndex({createdAt:-1}),await t.createIndex({sub1:1});let a=e.collection("postbacks");await a.createIndex({click_id:1,goal:1},{unique:!0}),await a.createIndex({affiliate_id:1}),await a.createIndex({createdAt:-1});let n=e.collection("ftds");await n.createIndex({click_id:1},{unique:!0}),await n.createIndex({affiliate_id:1}),await n.createIndex({createdAt:-1});let r=e.collection("admins");await r.createIndex({email:1},{unique:!0});let i=e.collection("conversions");await i.createIndex({click_id:1,goal_id:1},{unique:!0}),await i.createIndex({affiliate_id:1}),await i.createIndex({goal_type:1}),await i.createIndex({createdAt:-1}),console.log("✅ Database indexes created")}function l(e){return e.collection("contacts")}function d(e){return e.collection("postbacks")}function p(e){return e.collection("ftds")}function x(e){return e.collection("admins")}function f(e){return e.collection("conversions")}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[276,972],()=>a(1901));module.exports=n})();