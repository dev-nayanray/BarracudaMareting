(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{71:function(e,t,s){Promise.resolve().then(s.bind(s,586))},586:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var l=s(7437),a=s(2265),n=s(9376),r=s(9322),c=s(1671);s(9388);var i=s(7168),d=s(8896),x=s(525),o=s(5252);let m=(0,s(9205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var u=s(4772),p=s(6040),h=s(4226),f=s(9178),j=s(8068),v=s(9093);function g(){let e=(0,n.useRouter)(),{isAuthenticated:t,loading:s}=(0,u.Aj)(),[g,N]=(0,a.useState)([]),[b,y]=(0,a.useState)(!0),[w,k]=(0,a.useState)(null),[Z,C]=(0,a.useState)(null),[S,_]=(0,a.useState)(""),[T,A]=(0,a.useState)(""),[D,L]=(0,a.useState)("");(0,a.useEffect)(()=>{s||t||e.push("/admin/login")},[t,s,e]);let R=async()=>{try{y(!0),k(null);let e=await p.Z.getConversions();e.success?(N(e.data||[]),C(e.stats)):k(e.message||"Failed to fetch conversions")}catch(e){console.error("Failed to fetch conversions:",e),k("Failed to load conversions")}finally{y(!1)}};(0,a.useEffect)(()=>{t&&R()},[t]);let F=g.filter(e=>{var t,s,l;let a=!S||(null===(t=e.click_id)||void 0===t?void 0:t.toLowerCase().includes(S.toLowerCase()))||(null===(s=e.affiliate_id)||void 0===s?void 0:s.toLowerCase().includes(S.toLowerCase()))||(null===(l=e.goal_type)||void 0===l?void 0:l.toLowerCase().includes(S.toLowerCase())),n=!T||e.goal_type===T,r=!D||e.status===D;return a&&n&&r}),q=e=>{let t={registration:{color:"bg-blue-500/20 text-blue-400 border-blue-500/30",label:"Registration"},deposit:{color:"bg-accent-green/20 text-accent-green border-accent-green/30",label:"Deposit"}}[e]||{color:"bg-gray-500/20 text-gray-400 border-gray-500/30",label:e};return(0,l.jsx)("span",{className:"inline-flex px-2 py-1 rounded-full text-xs font-medium border ".concat(t.color),children:t.label})};if(s)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,l.jsx)("div",{className:"w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})});if(!t)return null;let O=F.reduce((e,t)=>{let s=t.click_id||"unknown";return e[s]||(e[s]=[]),e[s].push(t),e},{});return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-text",children:"Conversions"}),(0,l.jsx)("p",{className:"text-text-muted",children:"Track all conversion events and FTDs"})]}),(0,l.jsx)(h.Z,{variant:"outline",onClick:R,leftIcon:(0,l.jsx)(i.Z,{className:"w-4 h-4"}),children:"Refresh"})]}),Z&&(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsx)(f.Z,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.Z,{className:"w-5 h-5 text-primary-500"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-text",children:Z.total||0}),(0,l.jsx)("div",{className:"text-sm text-text-muted",children:"Total Conversions"})]})]})}),(0,l.jsx)(f.Z,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(x.Z,{className:"w-5 h-5 text-accent-green"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-accent-green",children:Z.approvedCount||0}),(0,l.jsx)("div",{className:"text-sm text-text-muted",children:"Approved"})]})]})}),(0,l.jsx)(f.Z,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(o.Z,{className:"w-5 h-5 text-secondary-500"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-secondary-400",children:["$",Z.totalAmount||0]}),(0,l.jsx)("div",{className:"text-sm text-text-muted",children:"Total Revenue"})]})]})}),(0,l.jsx)(f.Z,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.Z,{className:"w-5 h-5 text-accent-orange"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-accent-orange",children:Z.thisMonth||0}),(0,l.jsx)("div",{className:"text-sm text-text-muted",children:"This Month"})]})]})})]}),(null==Z?void 0:Z.byGoalType)&&Object.keys(Z.byGoalType).length>0&&(0,l.jsx)("div",{className:"flex flex-wrap gap-4",children:Object.entries(Z.byGoalType).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-surface-100 rounded-lg",children:[q(t),(0,l.jsxs)("span",{className:"text-text font-medium",children:[s," conversions"]})]},t)})}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(j.Z,{placeholder:"Search by click ID, affiliate ID, or goal type...",value:S,onChange:e=>_(e.target.value),leftIcon:(0,l.jsx)(m,{className:"w-4 h-4"})})}),(0,l.jsx)("div",{className:"w-full md:w-40",children:(0,l.jsx)(v.Z,{options:[{value:"",label:"All Goals"},{value:"registration",label:"Registration"},{value:"deposit",label:"Deposit"}],value:T,onChange:e=>A(e.target.value)})}),(0,l.jsx)("div",{className:"w-full md:w-40",children:(0,l.jsx)(v.Z,{options:[{value:"",label:"All Status"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}],value:D,onChange:e=>L(e.target.value)})})]}),w&&(0,l.jsxs)("div",{className:"p-4 bg-accent-red/10 border border-accent-red/30 rounded-xl flex items-center gap-3 text-accent-red",children:[(0,l.jsx)(r.Z,{className:"w-5 h-5"}),(0,l.jsx)("p",{children:w})]}),(0,l.jsx)("div",{className:"card overflow-hidden",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-surface-100 border-b border-surface-300",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Click ID"}),(0,l.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Affiliate"}),(0,l.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Conversions"}),(0,l.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Total Amount"}),(0,l.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"FTD Status"}),(0,l.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-text-muted uppercase tracking-wider",children:"Created"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-surface-300",children:b?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-3 text-text-muted",children:[(0,l.jsx)("div",{className:"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"}),"Loading conversions..."]})})}):0===F.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center text-text-muted",children:"No conversions found. Submit the contact form as an affiliate to create conversions."})}):Object.entries(O).map(e=>{var t,s,a;let[n,i]=e,x=i.some(e=>"deposit"===e.goal_type),m=i.some(e=>"registration"===e.goal_type),u=i.reduce((e,t)=>e+(t.amount||0),0);return i.every(e=>"approved"===e.status),(0,l.jsxs)("tr",{className:"hover:bg-surface-100/50 transition-colors",children:[(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-text font-mono text-sm",children:n}),(null===(t=i[0])||void 0===t?void 0:t.sub1)&&(0,l.jsxs)("p",{className:"text-xs text-text-muted",children:["sub1: ",i[0].sub1]})]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)("span",{className:"text-text font-mono text-sm",children:null===(s=i[0])||void 0===s?void 0:s.affiliate_id})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[m&&(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-500/10 text-blue-400 rounded text-xs",children:[(0,l.jsx)(d.Z,{className:"w-3 h-3"}),"Registration"]}),x&&(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-accent-green/10 text-accent-green rounded text-xs",children:[(0,l.jsx)(o.Z,{className:"w-3 h-3"}),"Deposit"]})]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-1 text-text",children:[(0,l.jsx)(o.Z,{className:"w-4 h-4 text-text-muted"}),(0,l.jsxs)("span",{className:"font-medium",children:["$",u]})]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:x?(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-accent-green/20 text-accent-green rounded text-xs font-medium",children:[(0,l.jsx)(c.Z,{className:"w-3 h-3"}),"FTD Complete"]}):(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-xs font-medium",children:[(0,l.jsx)(r.Z,{className:"w-3 h-3"}),"Pending"]})}),(0,l.jsx)("td",{className:"px-6 py-4 text-text-muted text-sm",children:(null===(a=i[0])||void 0===a?void 0:a.createdAt)?new Date(i[0].createdAt).toLocaleString():"-"})]},n)})})]})})}),!b&&F.length>0&&(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("p",{className:"text-sm text-text-muted",children:["Showing ",Object.keys(O).length," unique click(s) with ",F.length," conversion(s)"]})})]})}},9093:function(e,t,s){"use strict";var l=s(7437),a=s(2265),n=s(7062),r=s(875);let c=(0,a.forwardRef)((e,t)=>{let{label:s,placeholder:a="Select an option",options:c=[],value:i,onChange:d,onBlur:x,name:o,id:m,error:u,disabled:p=!1,required:h=!1,className:f="",leftIcon:j,helpText:v,...g}=e,N=m||o||"select-".concat(Math.random().toString(36).substr(2,9));return(0,l.jsxs)("div",{className:"w-full",children:[s&&(0,l.jsxs)("label",{htmlFor:N,className:"block text-sm font-medium text-text mb-2",children:[s,h&&(0,l.jsx)("span",{className:"text-accent-red ml-1",children:"*"})]}),(0,l.jsxs)("div",{className:"relative",children:[j&&(0,l.jsx)("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-text-muted",children:j}),(0,l.jsxs)("select",{ref:t,id:N,name:o,value:i,onChange:d,onBlur:x,disabled:p,required:h,className:(0,n.cn)("w-full px-4 py-3 bg-surface-200 border rounded-xl text-text appearance-none","cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary-500/20",u?"border-accent-red focus:border-accent-red":"border-surface-300 focus:border-primary-500",p&&"opacity-50 cursor-not-allowed",j&&"pl-11","transition-all duration-200",f),...g,children:[a&&(0,l.jsx)("option",{value:"",disabled:!0,children:a}),c.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,l.jsx)("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none",children:(0,l.jsx)(r.Z,{className:"h-5 w-5 text-text-muted"})})]}),u&&(0,l.jsx)("p",{className:"mt-1 text-sm text-accent-red",children:u}),v&&(0,l.jsx)("p",{className:"mt-1 text-sm text-text-muted",children:v})]})});c.displayName="Select",t.Z=c},875:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9388:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},5252:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},8896:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},525:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(9205).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])}},function(e){e.O(0,[790,971,117,744],function(){return e(e.s=71)}),_N_E=e.O()}]);